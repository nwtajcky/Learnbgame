no jumps are supported, so the rmap function was rewritten a little bit
to work around that. 